<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Coming from Pandas - Polars - User Guide</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="quickstart/intro.html"><strong aria-hidden="true">2.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="dsl/intro.html"><strong aria-hidden="true">3.</strong> Polars expressions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dsl/expressions.html"><strong aria-hidden="true">3.1.</strong> Expressions</a></li><li class="chapter-item "><a href="dsl/contexts.html"><strong aria-hidden="true">3.2.</strong> Contexts</a></li><li class="chapter-item "><a href="dsl/groupby.html"><strong aria-hidden="true">3.3.</strong> GroupBy</a></li><li class="chapter-item "><a href="dsl/folds.html"><strong aria-hidden="true">3.4.</strong> Folds</a></li><li class="chapter-item "><a href="dsl/window_functions.html"><strong aria-hidden="true">3.5.</strong> Window functions</a></li><li class="chapter-item "><a href="dsl/list_context.html"><strong aria-hidden="true">3.6.</strong> List context and row-wise compute</a></li><li class="chapter-item "><a href="dsl/numpy.html"><strong aria-hidden="true">3.7.</strong> Numpy universal functions</a></li><li class="chapter-item "><a href="dsl/custom_functions.html"><strong aria-hidden="true">3.8.</strong> Custom functions</a></li><li class="chapter-item "><a href="notebooks/introduction_polars.html"><strong aria-hidden="true">3.9.</strong> Examples</a></li><li class="chapter-item "><a href="dsl/api.html"><strong aria-hidden="true">3.10.</strong> API</a></li><li class="chapter-item "><a href="dsl/video_intro.html"><strong aria-hidden="true">3.11.</strong> Video introduction</a></li></ol></li><li class="chapter-item expanded "><a href="datatypes.html"><strong aria-hidden="true">4.</strong> Data Types</a></li><li class="chapter-item expanded "><a href="coming_from_pandas.html" class="active"><strong aria-hidden="true">5.</strong> Coming from Pandas</a></li><li class="chapter-item expanded "><a href="coming_from_spark.html"><strong aria-hidden="true">6.</strong> Coming from Apache Spark</a></li><li class="chapter-item expanded "><a href="howcani/intro.html"><strong aria-hidden="true">7.</strong> How can I?</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/io/intro.html"><strong aria-hidden="true">7.1.</strong> IO</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/io/csv.html"><strong aria-hidden="true">7.1.1.</strong> CSV files</a></li><li class="chapter-item "><a href="howcani/io/parquet.html"><strong aria-hidden="true">7.1.2.</strong> Parquet files</a></li><li class="chapter-item "><a href="multiple_files/intro.html"><strong aria-hidden="true">7.1.3.</strong> Multiple files</a></li><li class="chapter-item "><a href="howcani/io/read_db.html"><strong aria-hidden="true">7.1.4.</strong> Read from a database</a></li><li class="chapter-item "><a href="howcani/io/aws.html"><strong aria-hidden="true">7.1.5.</strong> Interact with AWS</a></li><li class="chapter-item "><a href="howcani/io/google-big-query.html"><strong aria-hidden="true">7.1.6.</strong> Interact with Google BigQuery</a></li><li class="chapter-item "><a href="howcani/io/postgres.html"><strong aria-hidden="true">7.1.7.</strong> Interact with Postgres</a></li><li class="chapter-item "><a href="howcani/interop/intro.html"><strong aria-hidden="true">7.1.8.</strong> Interoperability</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/interop/arrow.html"><strong aria-hidden="true">7.1.8.1.</strong> Arrow</a></li><li class="chapter-item "><a href="howcani/interop/numpy.html"><strong aria-hidden="true">7.1.8.2.</strong> NumPy</a></li></ol></li></ol></li><li class="chapter-item "><a href="howcani/selecting_data/selecting_data_intro.html"><strong aria-hidden="true">7.2.</strong> Selecting data</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/selecting_data/selecting_data_expressions.html"><strong aria-hidden="true">7.2.1.</strong> Selecting with expressions</a></li><li class="chapter-item "><a href="howcani/selecting_data/selecting_data_indexing.html"><strong aria-hidden="true">7.2.2.</strong> Selecting with indexing</a></li></ol></li><li class="chapter-item "><a href="howcani/data/intro.html"><strong aria-hidden="true">7.3.</strong> Data handling</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/data/strings.html"><strong aria-hidden="true">7.3.1.</strong> Process strings</a></li><li class="chapter-item "><a href="howcani/data/timestamps.html"><strong aria-hidden="true">7.3.2.</strong> Process timestamps</a></li><li class="chapter-item "><a href="howcani/missing_data.html"><strong aria-hidden="true">7.3.3.</strong> Process missing data</a></li></ol></li><li class="chapter-item "><a href="howcani/timeseries/intro.html"><strong aria-hidden="true">7.4.</strong> Time-series</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="howcani/timeseries/parsing_dates_times.html"><strong aria-hidden="true">7.4.1.</strong> Parsing dates and times</a></li><li class="chapter-item "><a href="howcani/timeseries/selecting_dates.html"><strong aria-hidden="true">7.4.2.</strong> Filtering by dates</a></li><li class="chapter-item "><a href="howcani/timeseries/temporal_groupby.html"><strong aria-hidden="true">7.4.3.</strong> Fixed and rolling temporal groupby</a></li><li class="chapter-item "><a href="howcani/timeseries/resampling.html"><strong aria-hidden="true">7.4.4.</strong> Resampling</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="performance/intro.html"><strong aria-hidden="true">8.</strong> Performance</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="performance/strings.html"><strong aria-hidden="true">8.1.</strong> Strings</a></li></ol></li><li class="chapter-item expanded "><a href="optimizations/intro.html"><strong aria-hidden="true">9.</strong> Optimizations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="optimizations/lazy/intro.html"><strong aria-hidden="true">9.1.</strong> Lazy API</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="optimizations/lazy/predicate-pushdown.html"><strong aria-hidden="true">9.1.1.</strong> Predicate pushdown</a></li><li class="chapter-item "><a href="optimizations/lazy/projection-pushdown.html"><strong aria-hidden="true">9.1.2.</strong> Projection pushdown</a></li><li class="chapter-item "><a href="optimizations/lazy/other-optimizations.html"><strong aria-hidden="true">9.1.3.</strong> Other optimizations</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="references.html"><strong aria-hidden="true">10.</strong> Reference guides</a></li><li class="chapter-item expanded "><a href="contributing.html"><strong aria-hidden="true">11.</strong> Contributing</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Polars - User Guide</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="coming-from-pandas"><a class="header" href="#coming-from-pandas">Coming from <code>Pandas</code></a></h1>
<p>Here we set out the key points that anyone who has experience with <code>Pandas</code> and wants to
try <code>Polars</code> should know. We include both differences in the concepts the libraries are
built on and differences in how you should write <code>Polars</code> code compared to <code>Pandas</code>
code.</p>
<h2 id="differences-in-concepts-between-polars-and-pandas"><a class="header" href="#differences-in-concepts-between-polars-and-pandas">Differences in concepts between <code>Polars</code> and <code>Pandas</code></a></h2>
<h3 id="polars-does-not-have-an-index"><a class="header" href="#polars-does-not-have-an-index"><code>Polars</code> does not have an index</a></h3>
<p><code>Pandas</code> gives a label to each row with an index. <code>Polars</code> does not use an index and
each row is indexed by its integer position in the table.</p>
<p>Indexes are not needed! Not having them makes things easier - convince us otherwise!</p>
<p>For more detail on how you select data in <code>Polars</code> see the <a href="howcani/selecting_data/selecting_data_intro.html">selecting data</a>
section.</p>
<h3 id="polars-uses-apache-arrow-arrays-to-represent-data-in-memory-while-pandas-uses-numpy-arrays"><a class="header" href="#polars-uses-apache-arrow-arrays-to-represent-data-in-memory-while-pandas-uses-numpy-arrays"><code>Polars</code> uses Apache Arrow arrays to represent data in memory while <code>Pandas</code> uses <code>Numpy</code> arrays</a></h3>
<p><code>Polars</code> represents data in memory with Arrow arrays while <code>Pandas</code> represents data in
memory in <code>Numpy</code> arrays. Apache Arrow is an emerging standard for in-memory columnar
analytics that can accelerate data load times, reduce memory usage and accelerate
calculations.</p>
<p><code>Polars</code> can convert data to <code>Numpy</code> format with the <code>to_numpy</code> method.</p>
<h3 id="polars-has-more-support-for-parallel-operations-than-pandas"><a class="header" href="#polars-has-more-support-for-parallel-operations-than-pandas"><code>Polars</code> has more support for parallel operations than <code>Pandas</code></a></h3>
<p><code>Polars</code> exploits the strong support for concurrency in Rust to run many operations in
parallel. While some operations in <code>Pandas</code> are multi-threaded the core of the library
is single-threaded and an additional library such as <code>Dask</code> must be used to parallelise
operations.</p>
<h3 id="polars-can-lazily-evaluate-queries-and-apply-query-optimization"><a class="header" href="#polars-can-lazily-evaluate-queries-and-apply-query-optimization"><code>Polars</code> can lazily evaluate queries and apply query optimization</a></h3>
<p>Eager evaluation is where code is evaluated as soon as you run the code. Lazy evaluation
is where running a line of code means that the underlying logic is added to a query plan
rather than being evaluated.</p>
<p><code>Polars</code> supports eager evaluation and lazy evaluation whereas <code>Pandas</code> only supports
eager evaluation. The lazy evaluation mode is powerful because <code>Polars</code> carries out
automatic query optimization where it examines the query plan and looks for ways to
accelerate the query or reduce memory usage.</p>
<p><code>Dask</code> also supports lazy evaluation where it generates a query plan. However, <code>Dask</code>
does not carry out query optimization on the query plan.</p>
<h2 id="key-syntax-differences"><a class="header" href="#key-syntax-differences">Key syntax differences</a></h2>
<p>Users coming from <code>Pandas</code> generally need to know one thing...</p>
<pre><code>polars != pandas
</code></pre>
<p>If your <code>Polars</code> code looks like it could be <code>Pandas</code> code, it might run, but it likely
runs slower than it should.</p>
<p>Let's go through some typical <code>Pandas</code> code and see how we might write that in <code>Polars</code>.</p>
<h3 id="selecting-data"><a class="header" href="#selecting-data">Selecting data</a></h3>
<p>As there is no index in <code>Polars</code> there is no <code>.loc</code> or <code>iloc</code> method in <code>Polars</code> - and
there is also no <code>SettingWithCopyWarning</code> in <code>Polars</code>.</p>
<p>To learn more about how you select data in <code>Polars</code> see the <a href="selecting_data/selecting_data_intro.html">selecting data</a> section.</p>
<p>However, the best way to select data in <code>Polars</code> is to use the expression API. For
example, if you want to select a column in <code>Pandas</code> you can do one of the following:</p>
<pre><code class="language-python">df['a']
df.loc[:,'a']
</code></pre>
<p>but in <code>Polars</code> you would use the <code>.select</code> method:</p>
<pre><code class="language-python">df.select(['a'])
</code></pre>
<p>If you want to select rows based on the values then in <code>Polars</code> you use the <code>.filter</code>
method:</p>
<pre><code class="language-python">df.filter(pl.col('a')&lt;10)
</code></pre>
<p>As noted in the section on expressions below, <code>Polars</code> can run operations in <code>.select</code>
and <code>filter</code> in parallel and <code>Polars</code> can carry out query optimization on the full set
of data selection criteria.</p>
<h3 id="be-lazy"><a class="header" href="#be-lazy">Be lazy</a></h3>
<p>Working in lazy evaluation mode is straightforward and should be your default in
<code>Polars</code> as the lazy mode allows <code>Polars</code> to do query optimization.</p>
<p>We can run in lazy mode by either using an implicitly lazy function (such as <code>scan_csv</code>)
or explicitly using the <code>lazy</code> method.</p>
<p>Take the following simple example where we read a CSV file from disk and do a groupby.
The CSV file has numerous columns but we just want to do a groupby on one of the id
columns (<code>id1</code>) and then sum by a value column (<code>v1</code>). In <code>Pandas</code> this would be:</p>
<pre><code class="language-python">    df = pd.read_csv(csvFile)
    groupedDf = df.loc[:,['id1','v1']].groupby('id1').sum('v1')
</code></pre>
<p>In <code>Polars</code> you can build this query in lazy mode with query optimization and evaluate
it by replacing the eager <code>Pandas</code> function <code>read_csv</code> with the implicitly lazy <code>Polars</code>
function <code>scan_csv</code>:</p>
<pre><code class="language-python">    df = pl.scan_csv(csvFile)
    groupedDf = df.groupby('id1').agg(pl.col('v1').sum()).collect()
</code></pre>
<p><code>Polars</code> optimizes this query by identifying that only the <code>id1</code> and <code>v1</code> columns are
relevant and so will only read these columns from the CSV. By calling the <code>.collect</code>
method at the end of the second line we instruct <code>Polars</code> to eagerly evaluate the query.</p>
<p>If you do want to run this query in eager mode you can just replace <code>scan_csv</code> with
<code>read_csv</code> in the <code>Polars</code> code.</p>
<p>Read more about working with lazy evaluation in the
<a href="optimizations/lazy/intro.html">lazy API</a> section.</p>
<h3 id="express-yourself"><a class="header" href="#express-yourself">Express yourself</a></h3>
<p>A typical <code>Pandas</code> script consists of multiple data transformations that are executed
sequentially. However, in <code>Polars</code> these transformations can be executed in parallel
using expressions.</p>
<h4 id="column-assignment"><a class="header" href="#column-assignment">Column assignment</a></h4>
<p>We have a dataframe <code>df</code> with a column called <code>value</code>. We want to add two new columns, a
column called <code>tenXValue</code> where the <code>value</code> column is multiplied by 10 and a column
called <code>hundredXValue</code> where the <code>value</code> column is multiplied by 100.</p>
<p>In <code>Pandas</code> this would be:</p>
<pre><code class="language-python">df[&quot;tenXValue&quot;] = df[&quot;value&quot;] * 10
df[&quot;hundredXValue&quot;] = df[&quot;value&quot;] * 100
</code></pre>
<p>These column assignments are executed sequentially.</p>
<p>In <code>Polars</code> we add columns to <code>df</code> using the <code>.with_column</code> method and name them with
the <code>.alias</code> method:</p>
<pre><code class="language-python">df.with_columns([
    (pl.col(&quot;value&quot;) * 10).alias(&quot;tenXValue&quot;),
    (pl.col(&quot;value&quot;) * 100).alias(&quot;hundredXValue&quot;),
])
</code></pre>
<p>These column assignments are executed in parallel.</p>
<h4 id="column-assignment-based-on-predicate"><a class="header" href="#column-assignment-based-on-predicate">Column assignment based on predicate</a></h4>
<p>In this case we have a dataframe <code>df</code> with columns <code>a</code>,<code>b</code> and <code>c</code>. We want to re-assign
the values in column <code>a</code> based on a condition. When the value in column <code>c</code> is equal to
2 then we replace the value in <code>a</code> with the value in <code>b</code>.</p>
<p>In <code>Pandas</code> this would be:</p>
<pre><code class="language-python">df.loc[df[&quot;c&quot;] == 2, &quot;a&quot;] = df.loc[df[&quot;c&quot;] == 2, &quot;b&quot;]
</code></pre>
<p>while in <code>Polars</code> this would be:</p>
<pre><code class="language-python">df.with_column(
    pl.when(pl.col(&quot;c&quot;) == 2)
    .then(pl.col(&quot;b&quot;))
    .otherwise(pl.col(&quot;a&quot;)).alias(&quot;a&quot;)
)
</code></pre>
<p>The <code>Polars</code> way is pure in that the original <code>DataFrame</code> is not modified. The <code>mask</code> is
also not computed twice as in <code>Pandas</code> (you could prevent this in <code>Pandas</code>, but that
would require setting a temporary variable).</p>
<p>Additionally <code>Polars</code> can compute every branch of an <code>if -&gt; then -&gt; otherwise</code> in
parallel. This is valuable, when the branches get more expensive to compute.</p>
<h4 id="filtering"><a class="header" href="#filtering">Filtering</a></h4>
<p>We want to filter the dataframe <code>df</code> with housing data based on some criteria.</p>
<p>In <code>Pandas</code> you filter the dataframe by passing Boolean expressions to the <code>loc</code> method:</p>
<pre><code class="language-python">df.loc[(df['sqft_living'] &gt; 2500) &amp; (df['price'] &lt; 300000)]
</code></pre>
<p>while in <code>Polars</code> you call the <code>filter</code> method:</p>
<pre><code class="language-python">df.filter(
    (pl.col(&quot;m2_living&quot;) &gt; 2500) &amp; (pl.col(&quot;price&quot;) &lt; 300000)
)
</code></pre>
<p>The query optimizer in <code>Polars</code> can also detect if you write multiple filters separately
and combine them into a single filter in the optimized plan.</p>
<h2 id="pandas-transform"><a class="header" href="#pandas-transform"><code>Pandas</code> transform</a></h2>
<p>The <code>Pandas</code> documentation demonstrates an operation on a groupby called <code>transform</code>. In
this case we have a dataframe <code>df</code> and we want a new column showing the number of rows
in each group.</p>
<p>In <code>Pandas</code> we have:</p>
<pre><code class="language-python">df = pd.DataFrame({
    &quot;type&quot;: [&quot;m&quot;, &quot;n&quot;, &quot;o&quot;, &quot;m&quot;, &quot;m&quot;, &quot;n&quot;, &quot;n&quot;],
    &quot;c&quot;: [1, 1, 1, 2, 2, 2, 2],
})

df[&quot;size&quot;] = df.groupby(&quot;c&quot;)[&quot;type&quot;].transform(len)
</code></pre>
<p>Here <code>Pandas</code> does a groupby on <code>&quot;c&quot;</code>, takes column <code>&quot;type&quot;</code>, computes the group length
and then joins the result back to the original <code>DataFrame</code> producing:</p>
<pre><code>   c type size
0  1    m    3
1  1    n    3
2  1    o    3
3  2    m    4
4  2    m    4
5  2    n    4
6  2    n    4
</code></pre>
<p>In <code>Polars</code> the same can be achieved with <code>window</code> functions:</p>
<pre><code class="language-python">df.select([
    pl.all(),
    pl.col(&quot;type&quot;).count().over(&quot;c&quot;).alias(&quot;size&quot;)
])
</code></pre>
<pre><code>shape: (7, 3)
┌─────┬──────┬──────┐
│ c   ┆ type ┆ size │
│ --- ┆ ---  ┆ ---  │
│ i64 ┆ str  ┆ u32  │
╞═════╪══════╪══════╡
│ 1   ┆ m    ┆ 3    │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┤
│ 1   ┆ n    ┆ 3    │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┤
│ 1   ┆ o    ┆ 3    │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┤
│ 2   ┆ m    ┆ 4    │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┤
│ 2   ┆ m    ┆ 4    │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┤
│ 2   ┆ n    ┆ 4    │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┤
│ 2   ┆ n    ┆ 4    │
└─────┴──────┴──────┘
</code></pre>
<p>Because we can store the whole operation in a single expression, we can combine several
<code>window</code> functions and even combine different groups!</p>
<p><code>Polars</code> will cache window expressions that are applied over the same group, so storing
them in a single <code>select</code> is both convenient <strong>and</strong> optimal. In the following example
we look at a case where we are calculating group statistics over <code>&quot;c&quot;</code> twice:</p>
<pre><code class="language-python">df.select([
    pl.all(),
    pl.col(&quot;c&quot;).count().over(&quot;c&quot;).alias(&quot;size&quot;),
    pl.col(&quot;c&quot;).sum().over(&quot;type&quot;).alias(&quot;sum&quot;),
    pl.col(&quot;c&quot;).reverse().over(&quot;c&quot;).flatten().alias(&quot;reverse_type&quot;)
])
</code></pre>
<pre><code>shape: (7, 5)
┌─────┬──────┬──────┬─────┬──────────────┐
│ c   ┆ type ┆ size ┆ sum ┆ reverse_type │
│ --- ┆ ---  ┆ ---  ┆ --- ┆ ---          │
│ i64 ┆ str  ┆ u32  ┆ i64 ┆ i64          │
╞═════╪══════╪══════╪═════╪══════════════╡
│ 1   ┆ m    ┆ 3    ┆ 5   ┆ 2            │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 1   ┆ n    ┆ 3    ┆ 5   ┆ 2            │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 1   ┆ o    ┆ 3    ┆ 1   ┆ 2            │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2   ┆ m    ┆ 4    ┆ 5   ┆ 2            │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2   ┆ m    ┆ 4    ┆ 5   ┆ 1            │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2   ┆ n    ┆ 4    ┆ 5   ┆ 1            │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2   ┆ n    ┆ 4    ┆ 5   ┆ 1            │
└─────┴──────┴──────┴─────┴──────────────┘

</code></pre>
<h2 id="missing-data"><a class="header" href="#missing-data">Missing data</a></h2>
<p><code>Pandas</code> uses <code>NaN</code> and/or <code>None</code> values to indicate missing values depending on the dtype of the column. In addition the behaviour in <code>Pandas</code> varies depending on whether the default dtypes or optional nullable arrays are used. In <code>Polars</code> missing data corresponds to a <code>null</code> value for all data types.</p>
<p>For float columns <code>Polars</code> permits the use of <code>NaN</code> values. These <code>NaN</code> values are not considered to be missing data but instead a special floating point value.</p>
<p>In <code>Pandas</code> an integer column with missing values is cast to be a float column with <code>NaN</code> values for the missing values (unless using optional nullable integer dtypes). In <code>Polars</code> any missing values in an integer column are simply <code>null</code> values and the column remains an integer column.</p>
<p>See the <a href="missing_data.html">missing data</a> section for more details.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="datatypes.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="coming_from_spark.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="datatypes.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="coming_from_spark.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
